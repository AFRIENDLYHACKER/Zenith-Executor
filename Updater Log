/**
 * Sets a cookie with the provided name, value, and expiration period.
 * @param {string} name - The name of the cookie.
 * @param {string} value - The value to be stored in the cookie.
 * @param {number} days - The number of days until the cookie expires.
 */
function setCookie(name, value, days) {
  var expires = "";
  if (days) {
    var date = new Date();
    date.setTime(date.getTime() + (days * 24 * 60 * 60 * 1000));
    expires = "; expires=" + date.toUTCString();
  }
  document.cookie = name + "=" + (value || "") + expires + "; path=/";
}

/**
 * Retrieves the value of a cookie by its name.
 * @param {string} name - The name of the cookie.
 * @returns {string|null} - The value of the cookie or null if not found.
 */
function getCookie(name) {
  var nameEQ = name + "=";
  var ca = document.cookie.split(';');
  for (var i = 0; i < ca.length; i++) {
    var c = ca[i];
    while (c.charAt(0) == ' ') c = c.substring(1, c.length);
    if (c.indexOf(nameEQ) == 0) return c.substring(nameEQ.length, c.length);
  }
  return null;
}

/**
 * Determines whether the update popup should be displayed based on the current and stored version numbers.
 * @returns {boolean} - True if the update popup should be displayed, false otherwise.
 */
function shouldShowUpdatePopup() {
  var currentVersion = 2.5;
  var lastShownVersion = parseFloat(getCookie('lastShownVersion')) || 0;

  return currentVersion > lastShownVersion;
}

/**
 * Displays a professionally styled update popup with version information and an update link.
 */
function showUpdatePopup() {
  var currentVersion = 2.5;
  var updateDescription = "Enhanced menu functionality with drag-and-drop capability, introduced Earthquake v3 for improved seismic visualization, and addressed multiple bugs for increased software stability.";
  var updateURL = "update-url";

  var popupContainer = document.createElement('div');
  popupContainer.className = 'popup';
  popupContainer.style.position = 'fixed';
  popupContainer.style.top = '50%';
  popupContainer.style.left = '50%';
  popupContainer.style.transform = 'translate(-50%, -50%)';
  popupContainer.style.backgroundColor = '#fff';
  popupContainer.style.boxShadow = '0 0 10px rgba(0, 0, 0, 0.1)';
  popupContainer.style.border = '1px solid #000'; // Black border
  popupContainer.style.padding = '20px';
  popupContainer.style.textAlign = 'center';
  popupContainer.style.borderRadius = '8px';
  popupContainer.style.maxWidth = '400px';
  popupContainer.style.width = '100%';
  popupContainer.style.fontFamily = 'Arial, sans-serif';
  popupContainer.style.zIndex = '999999';

  var versionText = document.createElement('p');
  versionText.innerText = 'Version ' + currentVersion;
  popupContainer.appendChild(versionText);

  var descriptionText = document.createElement('p');
  descriptionText.innerText = updateDescription;
  popupContainer.appendChild(descriptionText);

  var updateLink = document.createElement('a');
  updateLink.className = 'update-link';
  updateLink.href = updateURL;
  updateLink.innerText = 'Update Now';
  popupContainer.appendChild(document.createElement('br'));
  popupContainer.appendChild(document.createElement('br'));
  popupContainer.appendChild(updateLink);

  document.body.appendChild(popupContainer);

  setCookie('lastShownVersion', currentVersion, 365);
}

/**
 * Redirects the user to a specific link if the current URL contains the designated keyword.
 */
function redirectToSpecificLink() {
  if (window.location.href.includes("update-url")) {
    window.location.href = "specific-link.html";
  }
}

// Display the update popup if applicable
if (shouldShowUpdatePopup()) {
  showUpdatePopup();
}

// Check and perform redirection
redirectToSpecificLink();
// this should answer all questions nothing bad will happen
